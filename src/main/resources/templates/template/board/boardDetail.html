<!DOCTYPE html>
<html lang="en" xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <title>Hello World - 게시판</title>
</head>
<body>
<!-- 내용 시작 -->
<script th:src="@{/js/jquery-3.6.0.min.js}"></script>
<script th:src="@{/js/videoAdapter.js}"></script>
<script th:src="@{/js/board.fav.js}"></script>
<script th:src="@{/js/board.reply.js}"></script>
<div class="page-main">
    <h2>${board.title}</h2>
    <ul class="detail-info">
        <li>
            <img th:src="@{photoView?num=${board.id}}"
                 width="40" height="40" class="my-photo">
        </li>
        <li>
            ${board.username}
            <br>
            <div th:if="${board.date!=null and board.date.modify_date != null}"
                 th:text="|최근 수정일 : ${board.date.modify_date}|"></div>
            <div th:if="${board.date!=null and board.date.reg_date != null}"
                 th:text="|작성일 : ${board.date.reg_date}|"></div>
            조회 : ${board.hit}
        </li>
    </ul>
    <div th:if="${board.upload != null}">
        <ul>
            <li>첨부파일 : <a href="file?board_num=${board.board_num}">${board.filename}</a></li>
        </ul>
    </div>
    <hr size="1" width="100%">
    <th:block th:if="${#strings.endsWith(board.filename, '.jpg') ||
                     #strings.endsWith(board.filename, '.JPG') ||
                     #strings.endsWith(board.filename, '.jpeg') ||
                     #strings.endsWith(board.filename, '.JPEG') ||
                     #strings.endsWith(board.filename, '.gif') ||
                     #strings.endsWith(board.filename, '.GIF') ||
                     #strings.endsWith(board.filename, '.png') ||
                     #strings.endsWith(board.filename, '.PNG')}">
        <div class="align-center">
            <img th:src="@{/upload/{filename}(filename=${board.upload.filename})}" class="detail-img">
        </div>
    </th:block>
    <div class="detail-content">
        ${board.content}
    </div>
    <div>
        <%-- 좋아요 --%>
        <img th:id="output_fav" data-num="${board.id}"
             th:src="@{/images/board/fav01.gif}" width="40">
        <span id="output_fcount"></span>
        <%-- 댓글수 --%>
        <span id="output_rcount"></span>
    </div>
    <hr size="1" width="100%">
    <div class="align-right">
        <div th:if="${session.loginMember != null and session.loginMember.id == board.member.id}">
            <input type="button" value="수정" onclick="location.href='update?board_num=${board.board_num}'">
            <input type="button" value="삭제" id="delete_btn">
            <script type="text/javascript">
                let delete_btn = document.getElementById('delete_btn');
                delete_btn.onclick=function(){
                    let choice = confirm('삭제하시겠습니까?');
                    if(choice){
                        location.href='delete?board_num=${board.board_num}';
                    }
                }
            </script>
        </div>
        <input type="button" value="목록" th:onclick="|location.href='board'|">
    </div>
    <hr size="1" width="100%">
    <!-- 댓글 시작 -->
    <div id="reply_div">
        <span class="re-title">댓글 달기</span>
        <form id="re_form">
            <input type="hidden" th:name="board_id" th:value="${board.id}" th:id="board_id">
            <textarea rows="3" cols="50" th:name="boardReply_content" th:id="boardReply_content" class="rep-content"
                      th:disabled="${#strings.isEmpty(session.loginMember)}"
                      th:text="${#strings.isEmpty(session.loginMember) ? '로그인해야 작성할 수 있습니다.' : ''}"></textarea>
            <div th:if="${session.loginMember != null}">
                <div id="re_first">
                    <span class="letter-count">300/300</span>
                </div>
                <div id="re_second" class="align-right">
                    <input type="submit" value="전송">
                </div>
            </div>
        </form>
    </div>
    <!-- 댓글 목록 출력 시작-->
    <div id="output"></div>
    <div class="paging-button" style="display:none;">
        <input type="button" value="더보기">
    </div>
    <div id="loading" style="display:none;">
        <img th:src="@{/images/board/loading.gif}" width="100" height="100">
    </div>
    <!-- 댓글 목록 출력 끝-->
    <!-- 댓글 끝 -->
</div>
<!-- 내용 끝 -->
</body>
</html>